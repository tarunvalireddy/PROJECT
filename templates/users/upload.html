{% extends "users/user_base.html" %}
{% load static %}

{% block title %}Upload Evidence - Digital Evidence Management System{% endblock %}

{% block content %}

<div class="min-h-screen bg-gradient-to-br from-gray-900 via-blue-900 to-black flex items-center justify-center px-4 py-12">
    <div class="w-full max-w-lg">
        <!-- Main Card -->
        <div class="bg-white/10 backdrop-blur-xl rounded-3xl shadow-2xl overflow-hidden border border-white/20">
            <!-- Header -->
            <div class="bg-gradient-to-r from-blue-800 to-indigo-900 text-white px-8 py-10 text-center">
                <div class="inline-flex items-center justify-center w-16 h-16 bg-white/20 rounded-full mb-4">
                    <i class="fas fa-shield-alt fa-2x"></i>
                </div>
                <h2 class="text-4xl font-bold mb-3">Upload Evidence</h2>
                <p class="text-blue-100 text-lg opacity-90">
                    Securely upload digital files • Automatic SHA-256 hash generation • Tamper-proof integrity
                </p>
            </div>

            <!-- Body -->
            <div class="px-8 py-10">
                <!-- Success Message -->
                {% if msg %}
                    <div class="mb-8 p-5 bg-green-900/30 border border-green-500/50 text-green-300 rounded-xl flex items-center gap-3 animate-fade-in">
                        <i class="fas fa-check-circle fa-2x"></i>
                        <div>
                            <strong>Success!</strong> {{ msg }}
                        </div>
                    </div>
                {% endif %}

                <form method="POST" enctype="multipart/form-data" id="uploadForm">
                    {% csrf_token %}

                    <!-- Drag & Drop Upload Area -->
                    <div class="mb-8">
                        <label class="block text-lg font-medium text-gray-300 mb-4">
                            <i class="fas fa-file-upload me-2 text-blue-400"></i>Select or Drag Evidence File
                        </label>
                        <div class="border-2 border-dashed border-gray-500/50 rounded-2xl p-10 text-center hover:border-blue-400 transition duration-300 bg-white/5" 
                             id="dropZone">
                            <i class="fas fa-cloud-upload-alt fa-4x text-gray-500 mb-4"></i>
                            <p class="text-gray-400 text-lg">Drop your file here or click to browse</p>
                            <p class="text-sm text-gray-500 mt-2">Supported: JPG, PNG, PDF, DOC, DOCX • Max 10MB</p>
                            <input type="file" 
                                   class="hidden" 
                                   id="file" 
                                   name="file" 
                                   required 
                                   accept=".jpg,.jpeg,.png,.pdf,.doc,.docx">
                        </div>
                    </div>

                    <!-- Submit Button -->
                    <div class="d-grid">
                        <button type="submit" 
                                class="w-full bg-gradient-to-r from-blue-600 to-indigo-700 text-white font-bold text-xl py-5 rounded-xl hover:from-blue-700 hover:to-indigo-800 transform hover:scale-105 transition duration-300 shadow-xl flex items-center justify-center gap-3">
                            <i class="fas fa-lock fa-lg"></i>
                            Upload & Generate Hash
                        </button>
                    </div>
                </form>

                <!-- Footer Link -->
                <div class="text-center mt-10">
                    <p class="text-gray-400">
                        Already uploaded evidence? 
                        <a href="{% url 'verify_evidence' %}" class="text-blue-400 font-semibold hover:text-blue-300 underline transition">
                            Verify Integrity Here →
                        </a>
                    </p>
                </div>
            </div>
        </div>

        <!-- Subtle Footer -->
        <p class="text-center text-gray-500 mt-10 text-sm">
            Digital Evidence Management System • Powered by Secure Hashing & Immutable Logging
        </p>
    </div>
</div>

<!-- Drag & Drop JavaScript -->
<script>
    const dropZone = document.getElementById('dropZone');
    const fileInput = document.getElementById('file');

    dropZone.addEventListener('click', () => fileInput.click());

    dropZone.addEventListener('dragover', (e) => {
        e.preventDefault();
        dropZone.classList.add('border-blue-400', 'bg-blue-900/20');
    });

    dropZone.addEventListener('dragleave', () => {
        dropZone.classList.remove('border-blue-400', 'bg-blue-900/20');
    });

    dropZone.addEventListener('drop', (e) => {
        e.preventDefault();
        dropZone.classList.remove('border-blue-400', 'bg-blue-900/20');
        if (e.dataTransfer.files.length) {
            fileInput.files = e.dataTransfer.files;
        }
    });

    fileInput.addEventListener('change', () => {
        if (fileInput.files.length) {
            dropZone.innerHTML = `
                <i class="fas fa-file-check fa-4x text-green-400 mb-4"></i>
                <p class="text-green-300 text-lg font-medium">${fileInput.files[0].name}</p>
                <p class="text-sm text-gray-400">Ready to upload</p>
            `;
        }
    });
</script>

<style>
    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
    }
    .animate-fade-in { animation: fadeIn 0.6s ease-out; }
</style>

{% endblock %}